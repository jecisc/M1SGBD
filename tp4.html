<!--?xml version="1.0" encoding="iso-8859-1"?-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>

  <meta content="text/html; charset=windows-1252" http-equiv="content-type">
  <link href="tp4_fichiers/cours.css" rel="stylesheet" type="text/css">
  <title>cours SGBD</title>


</head>

<body>
<h1>TP XPath</h1>

<p>Ce TP est à réaliser avec BaseX sous Linux et un peu (pour l'exercice 2) SQLDeveloper.</p>

<h2>Exercice 1</h2>

<p>Le sujet est extrait du livre <em>Web Data Management</em>.</p>

<p>Les requêtes sont exprimées sur le document <a href="http://www.fil.univ-lille1.fr/%7Ecaronc/SGBD/movies_refs.xml"><code>movies_refs.xml</code></a>,

</p><h3>Question 1</h3>
<p>Exprimer en XPath les requêtes permettant d'obtenir :</p>

<ol>
<li>Les éléments <code>title</code></li>
<li>Les titres (i.e. chaînes de caractères) des films</li>
<li>Les titres des films sortis après 2000</li>
<li>Les titres qui contiennent un "V"</li>
<li>Les films qui ont exactement 3 acteurs</li>
<li>Le réalisateur de "Heat"</li>
<li>Les titres des films où figure Kirsten Dunst</li>
<li>Les films qui ont des résumés</li>
<li>Les films qui n'ont pas de résumé</li>
<li>Le rôle de Clint Eastwood dans "Unforgiven"</li>
<li>Le dernier film dans le document</li>
<li>Le titre du film qui précède immédiatement "Marie Antoinette" dans le document</li>
</ol>


<h3>Question 2 : Instruction conditionnelle</h3>

<p>A l'aide de l'instruction <code>if</code> donner les requêtes suivantes :</p>
<ol>
<li>Pour chaque artiste, s'il est né avant 1940 on donne son nom, sinon on donne son prénom.</li>
<li>Pour chaque artiste, s'il est né avant 1940 on donne son nom, sinon on ne donne rien.</li>
</ol>

<p>Est-ce que l'instruction conditionnelle <code>if</code> est indispensable pour exprimer ces requêtes, ou
est-ce qu'on peut y arriver avec une expression de chemin de type XPath 1.0 ?</p>

<h3>Question 3 : Boucle For</h3>

<p>Peut-on obtenir à l'aide d'une boucle <code>for</code> :</p><p>

</p><ol>
<li>l'ensemble des couples (nom,prenom) des réalisateurs ? </li>
<li>l'ensemble des noms et prénoms des réalisateurs ? </li>
</ol>

<p>Est-ce que dans les questions précédentes, une requête utilisant une boucle for
peut être remplacée par une requête utilisant une expression de chemin ? </p>

<h3>Question 4 : Expression quantifiée</h3>

<p>Peut-on exprimer les propositions suivantes, à l'aide d'expressions quantifiées ?</p>

<ol>
<li>Il existe des films avec 2 acteurs.</li>
<li>Tous les artistes sont présents dans tous les films</li>
<li>Tous les artistes sont présents dans au moins un film</li>
</ol>

<h2>Exercice 2</h2>

<p><em>Extrait de l'examen de décembre 2012.</em></p>

<p>On stocke dans une base de données relationnelle des informations concernant la généalogie de plusieurs familles.
On utilise une seule table pour stocker les informations, créée et remplie avec ce <a href="http://www.fil.univ-lille1.fr/%7Ecaronc/SGBD/genealogie-script.sql">script SQL</a>.</p>

<p>Exécutez ce script avant de répondre aux questions.</p>

<h3>Question 1</h3>

<p>A partir de cette table, on veut fabriquer un fichier XML contenant toutes les personnes. 
Ecrire une requête SQL/XML qui permet de passer des données de la table <code>PERSONNE</code> à <a href="http://www.fil.univ-lille1.fr/%7Ecaronc/SGBD/genealogie.xml">l'arbre XML suivant</a></p>

<h3>Question 2</h3>

<p>Donner les requêtes XPath qui permettent d'obtenir à partir du document XML précédent (<a href="http://www.fil.univ-lille1.fr/%7Ecaronc/SGBD/genealogie.xml">toute la famille</a>).</p>

<ol>
<li> l'année de naissance de la personne d'identifiant 6 </li>
<li> l'année de naissance de Marie LUCAS </li>
<li> les parents (éléments <code>personne</code>) de Guillaume OMNES né en 1815 </li>
<li> le nombre de frères et soeurs de la personne d'identifiant 7 </li>
</ol>

<h3>Question 3</h3>

<p> Donner les requêtes XPath qui permettent d'obtenir à partir du document <a href="http://www.fil.univ-lille1.fr/%7Ecaronc/SGBD/descendantsVB.xml"> des descendants de Vincent Bourel</a>.</p>

<ol>
<li>Les noms et prénoms des ancêtres de Yves OMNES.</li>
<li> Le nombre de frères et soeurs de la personne d'identifiant 71. </li>
<li> Le nombre de changements de patronyme. Il se produit à chaque fois que, dans l'arbre des descendants, une femme a des enfants.
En effet, un homme transmet son nom à ses enfants, mais une femme non.</li>
</ol>

<!--
<h3>Question 4</h3>

<p>Ecrire un programme PL/SQL qui permet de passer des données de la table <code>PERSONNE</code> 
à <a href="http://www.fil.univ-lille1.fr/~caronc/SGBD/descendantsVB.xml">l'arbre XML des descendants de Vincent Bourel</a>.</p>
-->




</body></html>